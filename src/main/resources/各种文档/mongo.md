# Mongo

MongoDB是==面向文档==的NoSQL数据库，用于大量数据存储

## 主要功能

1. 每个数据库都包含集合，集合有包含文档
   - 每个文档可以具有不同数量的字段
   - 每个文档的大小和内容可以互不相同
2. MongoDB的行不需要预先定义结构，相反，可以动态创建字段



## MongoDB架构的关键组件

1. _id：这是每个mongoDB文档的必填字段，表示mongoDB文档中的唯一值
   - 类似于主键，创建新文档时，如果没有_id字段，会自动创建该字段
2. 集合：这是mongoDB中，文档的分组
   - 等效于：关系型数据库中的表
   - 集合存在于单个数据库中
3. 游标：指向查询结果集的指针
4. 数据库：集合的容器，类似于关系型数据库的某个库
5. 文档：mongoDB集合中的记录，称为文档
   - 类似于关系型数据库的某条记录
   - 文档包含字段名和值
6. 字段：文档中的key/value对，一个文档可以具有0个或多个字段
7. Json：可读性高，用于表示结构化数据的纯文本格式





## 为什么需要MongoDB

1. 面向文档的，将数据存储在文档中，使得mongoDB非常灵活，可以适应实际的业务环境和需求
2. 临时查询
   - MongoDB支持按照字段、范围、正则表达式搜索，可以查询返回文档中的特定字段
3. 索引
   - 可以创建索引，以提高mongoDB的搜索性能
   - 文档中的任何字段都可以建立索引
4. 复制：提供了副本集的高可用
5. 负载均衡
   - 使用分片的功能，实现水平扩展





## mongoDB的数据建模

mongo的数据具有灵活的架构，不会强制执行文档结构，使得mongo具有很强的灵活性

在mongo中，对数据建模时，应注意以下几点

1. 应用程序的需求是什么
   - 基于需求确定文档的结构
2. 数据检索模式
   - 例如：使用大量的查询操作，那么考虑在数据模型中使用索引来提高查询效率
3. 数据库是否频繁发生crud操作
   - 如果数据建模设计需要重新考虑使用索引或合并分片，以提高整体mongo环境的效率



## mongoDB创建数据库和集合

- 使用“use”命令创建数据库
- 使用insert()创建集合
- 使用insert()添加文档
- find()查询文档
- sort、limit、orders字句类似sql语句的作用
- 学习的时，看api就可以了



## mongoDB安全、监控、备份

安全

1. 启用访问控制
2. 配置基于角色的访问控制
3. 尝试将mongoDB配置为某种加密协议
4. 配置审计
5. 使用单独的用户ID运行mongoDB服务器实例



mongoDB备份程序：mongodump

1. 通过复制底层数据文件进行备份
2. 使用mongodump备份数据库
3. mongoDB cloud manager备份



## 入门

### 数据库和集合

> MongoDB将Bson文档(即数据记录)，存储在集合Collection中，集合相当于关系型数据库表



### Collection

> 集合不存在时，在第一次存储数据到该集合时，Mongo会自动创建该集合



#### 文档

- 文档验证
  - 默认情况下，集合不要求其文档具有相同的模式，也就是说，单个集合的文档，不需要具有相同的字段集，且字段的数据类型在集合的不同文档之间可以不
  - 但是，从Mongo3.2开始，可以在更新和插入操作期间，对集合强制执行`文档验证规则`
- 修改文档结构
  - 可以动态更改集合中文档的结构。例如：添加新的字段、删除现有字段

#### 唯一标识符

> 集合被





修改文档结构

# MongoDB副本集

MongoDB的复制工具称为副本集，它提供以下功能

- 自动故障转移
- 数据冗余









# MongoDB分片

mongo中数据量很大时，会影响查询效率

mongo提出了分片的概念，将数据集拆分到多个MongoDB实例中

类似于：Mysql的分库分表

MongoDB的核心功能之一，是提供横向可扩展性

- 分片会将数据分布在机器集群上
- 



# 正则表达式

基本上用于文档中发现字符串















